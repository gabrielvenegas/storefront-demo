exports.id=208,exports.ids=[208],exports.modules={1502:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{N:()=>REGISTER});var apollo_angular__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7945),_common_graphql_fragments_graphql__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3976);const REGISTER=apollo_angular__WEBPACK_IMPORTED_MODULE_1__.gql`
    mutation Register($input: RegisterCustomerInput!) {
        registerCustomerAccount(input: $input) {
            ... on Success {
                success
            }
            ...ErrorResult
        }
    }
    ${_common_graphql_fragments_graphql__WEBPACK_IMPORTED_MODULE_0__.wq}
`},4208:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CheckoutModule:()=>CheckoutModule});var router=__webpack_require__(1756),shared_module=__webpack_require__(3014),of=__webpack_require__(5917),map=__webpack_require__(8002),filter=__webpack_require__(5435),switchMap=__webpack_require__(3190),shareReplay=__webpack_require__(2066),take=__webpack_require__(5257),mergeMap=__webpack_require__(1249),register_graphql=__webpack_require__(1502),not_null_or_undefined=__webpack_require__(38),core_cjs=__webpack_require__(7945),fragments_graphql=__webpack_require__(3976);const GET_ORDER_BY_CODE=core_cjs.gql`
    query GetOrderByCode($code: String!) {
        orderByCode(code: $code) {
            ...Cart
            updatedAt
            customer {
                id
                emailAddress
                firstName
                lastName
                user {
                    id
                    identifier
                    verified
                }
            }
        }
    }
    ${fragments_graphql.Gd}
`;var core=__webpack_require__(7716),state_service=__webpack_require__(3426),data_service=__webpack_require__(1199),common=__webpack_require__(8583),cart_contents_component=__webpack_require__(8593);function CheckoutConfirmationComponent_div_0_div_14_div_9_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",15),core._uU(1),core.qZA()),2&rf){const order_r2=core.oxw(2).ngIf;core.xp6(1),core.hij(" Great! Now check your email (",order_r2.customer.emailAddress,") to complete registration. ")}}function CheckoutConfirmationComponent_div_0_div_14_Template(rf,ctx){if(1&rf){const _r7=core.EpF();core.TgZ(0,"div",10),core.TgZ(1,"div",11),core.TgZ(2,"h3"),core._uU(3,"Create an account"),core.qZA(),core.qZA(),core.TgZ(4,"div",12),core.TgZ(5,"p",4),core._uU(6,"Create an account to enjoy faster checkouts, order tracking, order history and more!"),core.qZA(),core.TgZ(7,"button",13),core.NdJ("click",function CheckoutConfirmationComponent_div_0_div_14_Template_button_click_7_listener(){core.CHM(_r7);return core.oxw(2).register()}),core._uU(8," Create account "),core.qZA(),core.YNc(9,CheckoutConfirmationComponent_div_0_div_14_div_9_Template,2,1,"div",14),core.qZA(),core.qZA()}if(2&rf){const ctx_r3=core.oxw(2);core.xp6(7),core.Q6J("disabled",ctx_r3.registrationSent),core.xp6(2),core.Q6J("ngIf",ctx_r3.registrationSent)}}function CheckoutConfirmationComponent_div_0_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div"),core.TgZ(1,"div",1),core.TgZ(2,"h2",2),core._uU(3,"Thank you for your order!"),core.qZA(),core.TgZ(4,"ul",3),core.TgZ(5,"li",4),core.TgZ(6,"span",5),core._uU(7,"Order code:"),core.qZA(),core._uU(8),core.qZA(),core.TgZ(9,"li",4),core.TgZ(10,"span",5),core._uU(11,"Placed:"),core.qZA(),core._uU(12),core.ALo(13,"date"),core.qZA(),core.qZA(),core.qZA(),core.YNc(14,CheckoutConfirmationComponent_div_0_div_14_Template,10,2,"div",6),core.TgZ(15,"div",7),core.TgZ(16,"div",8),core._UZ(17,"vsf-cart-contents",9),core.qZA(),core.qZA(),core.qZA()),2&rf){const order_r2=ctx.ngIf;core.xp6(8),core.hij(" ",order_r2.code,""),core.xp6(4),core.hij(" ",core.xi3(13,5,order_r2.updatedAt,"medium"),""),core.xp6(2),core.Q6J("ngIf",!order_r2.customer.user),core.xp6(3),core.Q6J("cart",order_r2)("canAdjustQuantities",!1)}}function CheckoutConfirmationComponent_ng_container_2_Template(rf,ctx){1&rf&&(core.ynx(0),core.TgZ(1,"h2",2),core._uU(2,"Page not found"),core.qZA(),core.BQk())}class CheckoutConfirmationComponent{constructor(stateService,dataService,changeDetector,route){this.stateService=stateService,this.dataService=dataService,this.changeDetector=changeDetector,this.route=route,this.registrationSent=!1}ngOnInit(){const orderRequest$=this.route.paramMap.pipe((0,map.U)(paramMap=>paramMap.get("code")),(0,filter.h)(not_null_or_undefined.b),(0,switchMap.w)(code=>this.dataService.query(GET_ORDER_BY_CODE,{code:code})),(0,map.U)(data=>data.orderByCode),(0,shareReplay.d)(1));this.order$=orderRequest$.pipe((0,filter.h)(not_null_or_undefined.b)),this.notFound$=orderRequest$.pipe((0,map.U)(res=>!res))}register(){this.order$.pipe((0,take.q)(1),(0,mergeMap.zg)(order=>{const customer=null==order?void 0:order.customer;return customer?this.dataService.mutate(register_graphql.N,{input:{emailAddress:customer.emailAddress,firstName:customer.firstName,lastName:customer.lastName}}):(0,of.of)({})})).subscribe(()=>{this.registrationSent=!0,this.changeDetector.markForCheck()})}}CheckoutConfirmationComponent.\u0275fac=function CheckoutConfirmationComponent_Factory(t){return new(t||CheckoutConfirmationComponent)(core.Y36(state_service.b),core.Y36(data_service.D),core.Y36(core.sBO),core.Y36(router.gz))},CheckoutConfirmationComponent.\u0275cmp=core.Xpm({type:CheckoutConfirmationComponent,selectors:[["vsf-checkout-confirmation"]],decls:4,vars:6,consts:[[4,"ngIf"],[1,"text-center","mb-4"],[1,"display-4"],[1,"order-details","list-unstyled"],[1,"lead"],[1,"text-muted"],["class","account-signup card",4,"ngIf"],[1,"row","justify-content-center"],[1,"col-lg-8"],[3,"cart","canAdjustQuantities"],[1,"account-signup","card"],[1,"card-header"],[1,"card-body"],[1,"btn","btn-primary","btn-block",3,"disabled","click"],["class","registration-sent",4,"ngIf"],[1,"registration-sent"]],template:function CheckoutConfirmationComponent_Template(rf,ctx){1&rf&&(core.YNc(0,CheckoutConfirmationComponent_div_0_Template,18,8,"div",0),core.ALo(1,"async"),core.YNc(2,CheckoutConfirmationComponent_ng_container_2_Template,3,0,"ng-container",0),core.ALo(3,"async")),2&rf&&(core.Q6J("ngIf",core.lcZ(1,2,ctx.order$)),core.xp6(2),core.Q6J("ngIf",core.lcZ(3,4,ctx.notFound$)))},directives:[common.O5,cart_contents_component.o],pipes:[common.Ov,common.uU],styles:[".account-signup[_ngcontent-%COMP%]{max-width:400px;margin:auto auto 2rem}"],changeDetection:0});var tslib_es6=__webpack_require__(4762);const GET_ELIGIBLE_PAYMENT_METHODS=core_cjs.gql`
    query GetEligiblePaymentMethods {
        eligiblePaymentMethods {
            id
            code
            eligibilityMessage
            isEligible
        }
    }
`,ADD_PAYMENT=core_cjs.gql`
    mutation AddPayment($input: PaymentInput!) {
        addPaymentToOrder(input: $input) {
            ...Cart
            ...ErrorResult
        }
    }
    ${fragments_graphql.Gd}
    ${fragments_graphql.wq}
`;var fesm2015_forms=__webpack_require__(665),angular_fontawesome=__webpack_require__(4163);function CheckoutPaymentComponent_div_0_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",2),core._uU(1),core.qZA()),2&rf){const ctx_r0=core.oxw();core.xp6(1),core.hij(" ",ctx_r0.paymentErrorMessage,"\n")}}function CheckoutPaymentComponent_ng_container_1_option_21_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"option",19),core._uU(1),core.qZA()),2&rf){const month_r6=ctx.$implicit;core.Q6J("ngValue",month_r6),core.xp6(1),core.hij(" ",month_r6," ")}}function CheckoutPaymentComponent_ng_container_1_option_25_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"option",19),core._uU(1),core.qZA()),2&rf){const year_r7=ctx.$implicit;core.Q6J("ngValue",year_r7),core.xp6(1),core.hij(" ",year_r7," ")}}function CheckoutPaymentComponent_ng_container_1_Template(rf,ctx){if(1&rf){const _r9=core.EpF();core.ynx(0),core.TgZ(1,"div",3),core.TgZ(2,"div",4),core.TgZ(3,"h4"),core._uU(4),core.qZA(),core.TgZ(5,"div",5),core._uU(6," This is an example payment form. Do not use real card details! "),core.qZA(),core.qZA(),core.qZA(),core.TgZ(7,"form",6,7),core.NdJ("submit",function CheckoutPaymentComponent_ng_container_1_Template_form_submit_7_listener(){const paymentMethod_r2=core.CHM(_r9).$implicit;return core.oxw().completeOrder(paymentMethod_r2.code)}),core.TgZ(9,"div",8),core.TgZ(10,"div",9),core.TgZ(11,"span",10),core._UZ(12,"fa-icon",11),core.qZA(),core.qZA(),core.TgZ(13,"input",12),core.NdJ("ngModelChange",function CheckoutPaymentComponent_ng_container_1_Template_input_ngModelChange_13_listener($event){core.CHM(_r9);return core.oxw().cardNumber=$event}),core.qZA(),core.qZA(),core.TgZ(14,"div",8),core.TgZ(15,"div",9),core.TgZ(16,"label",13),core._uU(17,"Expiry"),core.qZA(),core.qZA(),core.TgZ(18,"select",14),core.NdJ("ngModelChange",function CheckoutPaymentComponent_ng_container_1_Template_select_ngModelChange_18_listener($event){core.CHM(_r9);return core.oxw().expMonth=$event}),core.TgZ(19,"option",15),core._uU(20,"Month"),core.qZA(),core.YNc(21,CheckoutPaymentComponent_ng_container_1_option_21_Template,2,2,"option",16),core.qZA(),core.TgZ(22,"select",17),core.NdJ("ngModelChange",function CheckoutPaymentComponent_ng_container_1_Template_select_ngModelChange_22_listener($event){core.CHM(_r9);return core.oxw().expYear=$event}),core.TgZ(23,"option",15),core._uU(24,"Year"),core.qZA(),core.YNc(25,CheckoutPaymentComponent_ng_container_1_option_25_Template,2,2,"option",16),core.qZA(),core.qZA(),core.TgZ(26,"button",18),core._uU(27,"Complete order "),core.qZA(),core.qZA(),core.BQk()}if(2&rf){const paymentMethod_r2=ctx.$implicit,_r3=core.MAs(8),ctx_r1=core.oxw();core.xp6(4),core.hij('Pay with method "',paymentMethod_r2.code,'"'),core.xp6(9),core.Q6J("required",!0)("ngModel",ctx_r1.cardNumber),core.xp6(5),core.Q6J("ngModel",ctx_r1.expMonth)("required",!0),core.xp6(1),core.Q6J("ngValue",void 0),core.xp6(2),core.Q6J("ngForOf",ctx_r1.getMonths()),core.xp6(1),core.Q6J("ngModel",ctx_r1.expYear)("required",!0),core.xp6(1),core.Q6J("ngValue",void 0),core.xp6(2),core.Q6J("ngForOf",ctx_r1.getYears()),core.xp6(1),core.Q6J("disabled",_r3.pristine||_r3.invalid)}}class CheckoutPaymentComponent{constructor(dataService,stateService,router,route){this.dataService=dataService,this.stateService=stateService,this.router=router,this.route=route}ngOnInit(){this.paymentMethods$=this.dataService.query(GET_ELIGIBLE_PAYMENT_METHODS).pipe((0,map.U)(res=>res.eligiblePaymentMethods))}getMonths(){return Array.from({length:12}).map((_,i)=>i+1)}getYears(){const year=(new Date).getFullYear();return Array.from({length:10}).map((_,i)=>year+i)}completeOrder(paymentMethodCode){this.dataService.mutate(ADD_PAYMENT,{input:{method:paymentMethodCode,metadata:{}}}).subscribe(({addPaymentToOrder:addPaymentToOrder})=>(0,tslib_es6.__awaiter)(this,void 0,void 0,function*(){switch(null==addPaymentToOrder?void 0:addPaymentToOrder.__typename){case"Order":const order=addPaymentToOrder;!order||"PaymentSettled"!==order.state&&"PaymentAuthorized"!==order.state||(yield new Promise(resolve=>setTimeout(()=>{this.stateService.setState("activeOrderId",null),resolve()},500)),this.router.navigate(["../confirmation",order.code],{relativeTo:this.route}));break;case"OrderPaymentStateError":case"PaymentDeclinedError":case"PaymentFailedError":case"OrderStateTransitionError":this.paymentErrorMessage=addPaymentToOrder.message}}))}}CheckoutPaymentComponent.\u0275fac=function CheckoutPaymentComponent_Factory(t){return new(t||CheckoutPaymentComponent)(core.Y36(data_service.D),core.Y36(state_service.b),core.Y36(router.F0),core.Y36(router.gz))},CheckoutPaymentComponent.\u0275cmp=core.Xpm({type:CheckoutPaymentComponent,selectors:[["vsf-checkout-payment"]],decls:3,vars:4,consts:[["class","alert alert-danger","role","alert",4,"ngIf"],[4,"ngFor","ngForOf"],["role","alert",1,"alert","alert-danger"],[1,"row"],[1,"col","col-lg-6","offset-lg-3"],["role","alert",1,"alert","alert-info","my-4"],[1,"payment-form","mb-5",3,"submit"],["paymentForm","ngForm"],[1,"input-group","mb-3"],[1,"input-group-prepend"],[1,"input-group-text"],["icon","credit-card"],["type","text","name","cardNumber","placeholder","Credit card #",1,"form-control",3,"required","ngModel","ngModelChange"],["for","month",1,"input-group-text"],["id","month","name","expMonth",1,"custom-select",3,"ngModel","required","ngModelChange"],["selected","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["id","year","name","expYear",1,"custom-select",3,"ngModel","required","ngModelChange"],[1,"btn","btn-primary","btn-lg",3,"disabled"],[3,"ngValue"]],template:function CheckoutPaymentComponent_Template(rf,ctx){1&rf&&(core.YNc(0,CheckoutPaymentComponent_div_0_Template,2,1,"div",0),core.YNc(1,CheckoutPaymentComponent_ng_container_1_Template,28,12,"ng-container",1),core.ALo(2,"async")),2&rf&&(core.Q6J("ngIf",ctx.paymentErrorMessage),core.xp6(1),core.Q6J("ngForOf",core.lcZ(2,2,ctx.paymentMethods$)))},directives:[common.O5,common.sg,fesm2015_forms._Y,fesm2015_forms.JL,fesm2015_forms.F,angular_fontawesome.BN,fesm2015_forms.Fj,fesm2015_forms.Q7,fesm2015_forms.JJ,fesm2015_forms.On,fesm2015_forms.EJ,fesm2015_forms.YN,fesm2015_forms.Kr],pipes:[common.Ov],styles:[".payment-form[_ngcontent-%COMP%]{max-width:400px;margin:auto}"],changeDetection:0});var startWith=__webpack_require__(9761);const GET_NEXT_ORDER_STATES=core_cjs.gql`
    query GetNextOrderStates {
        nextOrderStates
    }
`,TRANSITION_TO_ADDING_ITEMS=core_cjs.gql`
    mutation TransitionToAddingItems {
        transitionOrderToState(state: "AddingItems") {
            ...Cart
            ...ErrorResult
        }
    }
    ${fragments_graphql.Gd}
    ${fragments_graphql.wq}
`;function CheckoutStageIndicatorComponent_div_0_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",2),core.TgZ(1,"div",3),core._uU(2,"1"),core.qZA(),core.TgZ(3,"div",4),core._uU(4,"Account"),core.qZA(),core.qZA()),2&rf){const ctx_r0=core.oxw();core.ekj("active",1===ctx_r0.activeStage)}}function CheckoutStageIndicatorComponent_div_1_Template(rf,ctx){1&rf&&core._UZ(0,"div",5)}class CheckoutStageIndicatorComponent{constructor(){this.signedIn=!1,this.activeStage=1}}CheckoutStageIndicatorComponent.\u0275fac=function CheckoutStageIndicatorComponent_Factory(t){return new(t||CheckoutStageIndicatorComponent)},CheckoutStageIndicatorComponent.\u0275cmp=core.Xpm({type:CheckoutStageIndicatorComponent,selectors:[["vsf-checkout-stage-indicator"]],inputs:{signedIn:"signedIn",activeStage:"activeStage"},decls:19,vars:11,consts:[["class","stage",3,"active",4,"ngIf"],["class","line",4,"ngIf"],[1,"stage"],[1,"number"],[1,"label"],[1,"line"]],template:function CheckoutStageIndicatorComponent_Template(rf,ctx){1&rf&&(core.YNc(0,CheckoutStageIndicatorComponent_div_0_Template,5,2,"div",0),core.YNc(1,CheckoutStageIndicatorComponent_div_1_Template,1,0,"div",1),core.TgZ(2,"div",2),core.TgZ(3,"div",3),core._uU(4),core.qZA(),core.TgZ(5,"div",4),core._uU(6,"Shipping"),core.qZA(),core.qZA(),core._UZ(7,"div",5),core.TgZ(8,"div",2),core.TgZ(9,"div",3),core._uU(10),core.qZA(),core.TgZ(11,"div",4),core._uU(12,"Payment"),core.qZA(),core.qZA(),core._UZ(13,"div",5),core.TgZ(14,"div",2),core.TgZ(15,"div",3),core._uU(16),core.qZA(),core.TgZ(17,"div",4),core._uU(18,"Complete"),core.qZA(),core.qZA()),2&rf&&(core.Q6J("ngIf",!ctx.signedIn),core.xp6(1),core.Q6J("ngIf",!ctx.signedIn),core.xp6(1),core.ekj("active",2===ctx.activeStage),core.xp6(2),core.Oqu(ctx.signedIn?1:2),core.xp6(4),core.ekj("active",3===ctx.activeStage),core.xp6(2),core.Oqu(ctx.signedIn?2:3),core.xp6(4),core.ekj("active",4===ctx.activeStage),core.xp6(2),core.Oqu(ctx.signedIn?3:4))},directives:[common.O5],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;max-width:600px;margin:0 auto 2rem}.stage[_ngcontent-%COMP%], .stage[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{display:flex;align-items:center}.stage[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{border-radius:50%;width:24px;height:24px;background-color:#f8f9fa;justify-content:center;transition:background-color .2s}.stage.active[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.stage.active[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#212529}.stage[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin-left:.5rem;color:#6c757d}.line[_ngcontent-%COMP%]{flex:1;height:0;border-bottom:1px solid #dee2e6;margin:0 .5rem}"],changeDetection:0});var address_card_component=__webpack_require__(246);function CheckoutProcessComponent_div_6_vsf_address_card_2_button_1_Template(rf,ctx){if(1&rf){const _r5=core.EpF();core.TgZ(0,"button",9),core.NdJ("click",function CheckoutProcessComponent_div_6_vsf_address_card_2_button_1_Template_button_click_0_listener(){core.CHM(_r5);return core.oxw(3).changeShippingAddress()}),core._uU(1,"Change "),core.qZA()}}function CheckoutProcessComponent_div_6_vsf_address_card_2_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"vsf-address-card",7),core.YNc(1,CheckoutProcessComponent_div_6_vsf_address_card_2_button_1_Template,2,0,"button",8),core.ALo(2,"async"),core.qZA()),2&rf){const cart_r1=core.oxw().ngIf,ctx_r2=core.oxw();core.Q6J("address",cart_r1.shippingAddress),core.xp6(1),core.Q6J("ngIf",3===core.lcZ(2,2,ctx_r2.activeStage$))}}function CheckoutProcessComponent_div_6_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",4),core._UZ(1,"vsf-cart-contents",5),core.YNc(2,CheckoutProcessComponent_div_6_vsf_address_card_2_Template,3,4,"vsf-address-card",6),core.qZA()),2&rf){const cart_r1=ctx.ngIf;core.xp6(1),core.Q6J("cart",cart_r1),core.xp6(1),core.Q6J("ngIf",null==cart_r1.shippingAddress?null:cart_r1.shippingAddress.streetLine1)}}class CheckoutProcessComponent{constructor(dataService,stateService,route,router){this.dataService=dataService,this.stateService=stateService,this.route=route,this.router=router}ngOnInit(){this.signedIn$=this.stateService.select(state=>state.signedIn),this.cart$=this.route.data.pipe((0,switchMap.w)(data=>data.activeOrder)),this.nextStates$=this.dataService.query(GET_NEXT_ORDER_STATES).pipe((0,map.U)(data=>data.nextOrderStates)),this.activeStage$=this.router.events.pipe((0,filter.h)(event=>event instanceof router.m2),(0,startWith.O)(!0),(0,map.U)(()=>{const firstChild=this.route.snapshot.firstChild;if(firstChild&&firstChild.routeConfig)switch(firstChild.routeConfig.path){case"":return 1;case"shipping":return 2;case"payment":return 3;case"confirmation/:code":return 4}return 1}))}changeShippingAddress(){this.dataService.mutate(TRANSITION_TO_ADDING_ITEMS).subscribe(()=>{this.router.navigate(["./shipping"],{relativeTo:this.route})})}}CheckoutProcessComponent.\u0275fac=function CheckoutProcessComponent_Factory(t){return new(t||CheckoutProcessComponent)(core.Y36(data_service.D),core.Y36(state_service.b),core.Y36(router.gz),core.Y36(router.F0))},CheckoutProcessComponent.\u0275cmp=core.Xpm({type:CheckoutProcessComponent,selectors:[["vsf-checkout-process"]],decls:8,vars:9,consts:[[1,"container","checkout-wrapper"],[1,"main"],[3,"activeStage","signedIn"],["class","summary",4,"ngIf"],[1,"summary"],[1,"mb-3",3,"cart"],["title","Shipping address",3,"address",4,"ngIf"],["title","Shipping address",3,"address"],["class","btn btn-secondary",3,"click",4,"ngIf"],[1,"btn","btn-secondary",3,"click"]],template:function CheckoutProcessComponent_Template(rf,ctx){1&rf&&(core.TgZ(0,"div",0),core.TgZ(1,"div",1),core._UZ(2,"vsf-checkout-stage-indicator",2),core.ALo(3,"async"),core.ALo(4,"async"),core._UZ(5,"router-outlet"),core.qZA(),core.YNc(6,CheckoutProcessComponent_div_6_Template,3,2,"div",3),core.ALo(7,"async"),core.qZA()),2&rf&&(core.xp6(2),core.Q6J("activeStage",core.lcZ(3,3,ctx.activeStage$))("signedIn",core.lcZ(4,5,ctx.signedIn$)),core.xp6(4),core.Q6J("ngIf",core.lcZ(7,7,ctx.cart$)))},directives:[CheckoutStageIndicatorComponent,router.lC,common.O5,cart_contents_component.o,address_card_component.l],pipes:[common.Ov],styles:[".checkout-wrapper[_ngcontent-%COMP%]{display:flex;margin-top:2rem}@media (max-width:767.98px){.checkout-wrapper[_ngcontent-%COMP%]{flex-direction:column}.checkout-wrapper[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{margin-right:0}.checkout-wrapper[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]{margin-left:0}}.main[_ngcontent-%COMP%]{flex:1;margin-right:1rem}.summary[_ngcontent-%COMP%]{min-width:300px;margin-left:1rem}.summary[_ngcontent-%COMP%]   vsf-cart-contents[_ngcontent-%COMP%]{max-height:50vh}.shipping-address[_ngcontent-%COMP%]{margin-top:1rem;padding:1rem;border:1px solid #eee;border-radius:3px}.shipping-address[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-weight:400;font-size:14px}.shipping-address[_ngcontent-%COMP%]   .address-line[_ngcontent-%COMP%]{font-size:12px;color:#6c757d}"],changeDetection:0});var combineLatest=__webpack_require__(9112),tap=__webpack_require__(8307),documents_graphql=__webpack_require__(8469),address_modal_component=__webpack_require__(3254);const GET_SHIPPING_ADDRESS=core_cjs.gql`
    query GetShippingAddress {
        activeOrder {
            id
            shippingAddress {
                ...OrderAddress
            }
        }
    }
    ${fragments_graphql.sO}
`,SET_SHIPPING_ADDRESS=core_cjs.gql`
    mutation SetShippingAddress($input: CreateAddressInput!) {
        setOrderShippingAddress(input: $input) {
            ...Cart
            ...on Order {
                shippingAddress {
                    ...OrderAddress
                }
            }
            ...ErrorResult
        }
    }
    ${fragments_graphql.Gd}
    ${fragments_graphql.sO}
    ${fragments_graphql.wq}
`,GET_ELIGIBLE_SHIPPING_METHODS=core_cjs.gql`
    query GetEligibleShippingMethods {
        eligibleShippingMethods {
            id
            name
            description
            price
            priceWithTax
            metadata
        }
    }
`,SET_SHIPPING_METHOD=core_cjs.gql`
    mutation SetShippingMethod($id: ID!) {
        setOrderShippingMethod(shippingMethodId: $id) {
            ...Cart
            ...ErrorResult
        }
    }
    ${fragments_graphql.Gd}
    ${fragments_graphql.wq}
`,SET_CUSTOMER_FOR_ORDER=core_cjs.gql`
    mutation SetCustomerForOrder($input: CreateCustomerInput!) {
        setCustomerForOrder(input: $input) {
            ...on Order {
                id
                customer {
                    id
                    emailAddress
                    firstName
                    lastName
                }
            }
            ...ErrorResult
        }
    }
    ${fragments_graphql.wq}
`,TRANSITION_TO_ARRANGING_PAYMENT=core_cjs.gql`
    mutation TransitionToArrangingPayment {
        transitionOrderToState(state: "ArrangingPayment") {
            ...Cart
            ...ErrorResult
        }
    }
    ${fragments_graphql.Gd}
    ${fragments_graphql.wq}
`;var overlay=__webpack_require__(4687),fesm2015_portal=__webpack_require__(7636),Observable=__webpack_require__(7574),race=__webpack_require__(8085),mapTo=__webpack_require__(6736),finalize=__webpack_require__(8939),modal_dialog_component=__webpack_require__(9406),modal_types=__webpack_require__(3959);class ModalService{constructor(overlay,injector){this.overlay=overlay,this.injector=injector}fromComponent(component,options){const positionStrategy=this.overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy=this.overlay.scrollStrategies.block(),overlayRef=this.overlay.create(new overlay.X_({scrollStrategy:scrollStrategy,positionStrategy:positionStrategy,hasBackdrop:!0})),portal=new fesm2015_portal.C5(modal_dialog_component.h,null,this.createInjector(component,options)),modal=overlayRef.attach(portal);setTimeout(()=>modal.changeDetectorRef.markForCheck());const close$=new Observable.y(subscriber=>{modal.instance.closeModal=result=>{subscriber.next(result),subscriber.complete()}}),backdropClick$=overlayRef.backdropClick().pipe((0,mapTo.h)(void 0));return(0,race.S3)(close$,backdropClick$).pipe((0,take.q)(1),(0,finalize.x)(()=>overlayRef.dispose()))}createInjector(component,options){const weakMap=new WeakMap([[modal_types.L,component],[modal_types.l,options]]);return new fesm2015_portal.nK(this.injector,weakMap)}}ModalService.\u0275fac=function ModalService_Factory(t){return new(t||ModalService)(core.LFG(overlay.aV),core.LFG(core.zs3))},ModalService.\u0275prov=core.Yz7({token:ModalService,factory:ModalService.\u0275fac,providedIn:"root"});var notification_service=__webpack_require__(4497),address_form_component=__webpack_require__(4990),format_price_pipe=__webpack_require__(407);const _c0=["addressForm"];function CheckoutShippingComponent_div_1_div_6_div_1_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",15),core._uU(1),core.qZA()),2&rf){const line_r7=ctx.$implicit;core.xp6(1),core.hij(" ",line_r7," ")}}function CheckoutShippingComponent_div_1_div_6_Template(rf,ctx){if(1&rf){const _r9=core.EpF();core.TgZ(0,"div",13),core.NdJ("click",function CheckoutShippingComponent_div_1_div_6_Template_div_click_0_listener(){const address_r5=core.CHM(_r9).$implicit;return core.oxw(2).setShippingAddress(address_r5)}),core.YNc(1,CheckoutShippingComponent_div_1_div_6_div_1_Template,2,1,"div",14),core.qZA()}if(2&rf){const address_r5=ctx.$implicit,ctx_r4=core.oxw(2);core.xp6(1),core.Q6J("ngForOf",ctx_r4.getLines(address_r5))}}function CheckoutShippingComponent_div_1_Template(rf,ctx){if(1&rf){const _r11=core.EpF();core.TgZ(0,"div",2),core.TgZ(1,"div",3),core.TgZ(2,"button",8),core.NdJ("click",function CheckoutShippingComponent_div_1_Template_button_click_2_listener(){core.CHM(_r11);return core.oxw().step="selectAddress"}),core._uU(3,"Select Address"),core.qZA(),core.qZA(),core.TgZ(4,"div",5),core.TgZ(5,"div",9),core.YNc(6,CheckoutShippingComponent_div_1_div_6_Template,2,1,"div",10),core.ALo(7,"async"),core.TgZ(8,"div",11),core.TgZ(9,"button",12),core.NdJ("click",function CheckoutShippingComponent_div_1_Template_button_click_9_listener(){core.CHM(_r11);return core.oxw().createAddress()}),core._uU(10,"Add new address"),core.qZA(),core.qZA(),core.qZA(),core.qZA(),core.qZA()}if(2&rf){const ctx_r0=core.oxw();core.xp6(4),core.ekj("show","selectAddress"===ctx_r0.step),core.xp6(2),core.Q6J("ngForOf",core.lcZ(7,3,ctx_r0.customerAddresses$))}}function CheckoutShippingComponent_div_4_Template(rf,ctx){if(1&rf){const _r15=core.EpF();core.TgZ(0,"div",2),core.TgZ(1,"div",3),core.TgZ(2,"button",8),core.NdJ("click",function CheckoutShippingComponent_div_4_Template_button_click_2_listener(){core.CHM(_r15);return core.oxw().step="customerDetails"}),core._uU(3,"Customer Details"),core.qZA(),core.qZA(),core.TgZ(4,"div",5),core.TgZ(5,"form",null,16),core.TgZ(7,"div",17),core.TgZ(8,"input",18),core.NdJ("ngModelChange",function CheckoutShippingComponent_div_4_Template_input_ngModelChange_8_listener($event){core.CHM(_r15);return core.oxw().firstName=$event}),core.qZA(),core.TgZ(9,"input",19),core.NdJ("ngModelChange",function CheckoutShippingComponent_div_4_Template_input_ngModelChange_9_listener($event){core.CHM(_r15);return core.oxw().lastName=$event}),core.qZA(),core.TgZ(10,"input",20),core.NdJ("ngModelChange",function CheckoutShippingComponent_div_4_Template_input_ngModelChange_10_listener($event){core.CHM(_r15);return core.oxw().emailAddress=$event}),core.qZA(),core.qZA(),core.qZA(),core.TgZ(11,"button",7),core.NdJ("click",function CheckoutShippingComponent_div_4_Template_button_click_11_listener(){core.CHM(_r15);return core.oxw().setCustomerDetails()}),core._uU(12,"Next"),core.qZA(),core.qZA(),core.qZA()}if(2&rf){const _r13=core.MAs(6),ctx_r1=core.oxw();core.xp6(4),core.ekj("show","customerDetails"===ctx_r1.step),core.xp6(4),core.Q6J("ngModel",ctx_r1.firstName),core.xp6(1),core.Q6J("ngModel",ctx_r1.lastName),core.xp6(1),core.Q6J("ngModel",ctx_r1.emailAddress),core.xp6(1),core.Q6J("disabled",_r13.invalid)}}function CheckoutShippingComponent_div_6_Template(rf,ctx){if(1&rf){const _r22=core.EpF();core.TgZ(0,"div",2),core.TgZ(1,"div",3),core.TgZ(2,"button",4),core.NdJ("click",function CheckoutShippingComponent_div_6_Template_button_click_2_listener(){core.CHM(_r22);return core.oxw().step="editAddress"}),core._uU(3,"Shipping Address"),core.qZA(),core.qZA(),core.TgZ(4,"div",5),core._UZ(5,"vsf-address-form",21,22),core.ALo(7,"async"),core.ALo(8,"async"),core.TgZ(9,"button",7),core.NdJ("click",function CheckoutShippingComponent_div_6_Template_button_click_9_listener(){core.CHM(_r22);const _r20=core.MAs(6);return core.oxw().setShippingAddress(_r20.addressForm.value)}),core._uU(10,"Send to this address"),core.qZA(),core.qZA(),core.qZA()}if(2&rf){const _r20=core.MAs(6),ctx_r2=core.oxw();core.xp6(2),core.Q6J("disabled","customerDetails"===ctx_r2.step),core.xp6(2),core.ekj("show","editAddress"===ctx_r2.step),core.xp6(1),core.Q6J("address",core.lcZ(7,6,ctx_r2.shippingAddress$))("availableCountries",core.lcZ(8,8,ctx_r2.availableCountries$)),core.xp6(4),core.Q6J("disabled",_r20.addressForm.invalid)}}function CheckoutShippingComponent_div_15_Template(rf,ctx){if(1&rf){const _r26=core.EpF();core.TgZ(0,"div",23),core.TgZ(1,"input",24),core.NdJ("ngModelChange",function CheckoutShippingComponent_div_15_Template_input_ngModelChange_1_listener($event){core.CHM(_r26);return core.oxw().shippingMethodId=$event}),core.qZA(),core.TgZ(2,"label",25),core.TgZ(3,"div",26),core._uU(4),core.qZA(),core.TgZ(5,"div",27),core._uU(6),core.ALo(7,"formatPrice"),core.qZA(),core.qZA(),core.qZA()}if(2&rf){const method_r24=ctx.$implicit,ctx_r3=core.oxw();core.xp6(1),core.Q6J("ngModel",ctx_r3.shippingMethodId)("value",method_r24.id)("id",method_r24.id),core.xp6(1),core.Q6J("for",method_r24.id),core.xp6(2),core.Oqu(method_r24.name),core.xp6(2),core.Oqu(core.lcZ(7,6,method_r24.priceWithTax))}}class CheckoutShippingComponent{constructor(dataService,stateService,changeDetector,modalService,notificationService,route,router){this.dataService=dataService,this.stateService=stateService,this.changeDetector=changeDetector,this.modalService=modalService,this.notificationService=notificationService,this.route=route,this.router=router,this.step="selectAddress",this.firstName="",this.lastName="",this.emailAddress=""}ngOnInit(){this.signedIn$=this.stateService.select(state=>state.signedIn),this.customerAddresses$=this.dataService.query(documents_graphql.K5).pipe((0,map.U)(data=>data.activeCustomer&&data.activeCustomer.addresses||[])),this.availableCountries$=this.dataService.query(documents_graphql.n1).pipe((0,map.U)(data=>data.availableCountries)),this.shippingAddress$=this.dataService.query(GET_SHIPPING_ADDRESS).pipe((0,map.U)(data=>data.activeOrder&&data.activeOrder.shippingAddress)),this.eligibleShippingMethods$=this.shippingAddress$.pipe((0,switchMap.w)(()=>this.dataService.query(GET_ELIGIBLE_SHIPPING_METHODS)),(0,map.U)(data=>data.eligibleShippingMethods)),(0,combineLatest.aj)(this.signedIn$,this.customerAddresses$).pipe((0,take.q)(1)).subscribe(([signedIn,addresses])=>{this.step=signedIn?addresses.length?"selectAddress":"editAddress":"customerDetails"})}getLines(address){return[address.fullName,address.company,address.streetLine1,address.streetLine2,address.province,address.postalCode,address.country.name].filter(not_null_or_undefined.b)}createAddress(){this.modalService.fromComponent(address_modal_component.$,{locals:{title:"Create new address"},closable:!0}).pipe((0,switchMap.w)(()=>this.dataService.query(documents_graphql.K5,null,"network-only"))).subscribe()}editAddress(address){this.addressForm.addressForm.patchValue(Object.assign(Object.assign({},address),{countryCode:address.country.code})),this.step="editAddress"}setCustomerDetails(){this.addressForm.addressForm.patchValue({fullName:`${this.firstName} ${this.lastName}`}),this.step="editAddress"}setShippingAddress(value){const input=this.valueToAddressInput(value);this.dataService.mutate(SET_SHIPPING_ADDRESS,{input:input}).subscribe(data=>{this.step="selectMethod",this.changeDetector.markForCheck()})}proceedToPayment(){const shippingMethodId=this.shippingMethodId;shippingMethodId&&this.stateService.select(state=>state.signedIn).pipe((0,mergeMap.zg)(signedIn=>signedIn?(0,of.of)({}):this.setCustomerForOrder()||(0,of.of)({})),(0,mergeMap.zg)(()=>this.dataService.mutate(SET_SHIPPING_METHOD,{id:shippingMethodId})),(0,mergeMap.zg)(()=>this.dataService.mutate(TRANSITION_TO_ARRANGING_PAYMENT))).subscribe(data=>{this.router.navigate(["../payment"],{relativeTo:this.route})})}setCustomerForOrder(){if(this.emailAddress)return this.dataService.mutate(SET_CUSTOMER_FOR_ORDER,{input:{emailAddress:this.emailAddress,firstName:this.firstName,lastName:this.lastName}}).pipe((0,tap.b)(({setCustomerForOrder:setCustomerForOrder})=>{setCustomerForOrder&&"Order"!==setCustomerForOrder.__typename&&this.notificationService.error(setCustomerForOrder.message)}))}valueToAddressInput(value){return{city:value.city||"",company:value.company||"",countryCode:this.isFormValue(value)?value.countryCode:value.country.code,defaultBillingAddress:value.defaultBillingAddress,defaultShippingAddress:value.defaultShippingAddress,fullName:value.fullName||"",phoneNumber:value.phoneNumber||"",postalCode:value.postalCode||"",province:value.province||"",streetLine1:value.streetLine1||"",streetLine2:value.streetLine2||""}}isFormValue(input){return"string"==typeof input.countryCode}}CheckoutShippingComponent.\u0275fac=function CheckoutShippingComponent_Factory(t){return new(t||CheckoutShippingComponent)(core.Y36(data_service.D),core.Y36(state_service.b),core.Y36(core.sBO),core.Y36(ModalService),core.Y36(notification_service.g),core.Y36(router.gz),core.Y36(router.F0))},CheckoutShippingComponent.\u0275cmp=core.Xpm({type:CheckoutShippingComponent,selectors:[["vsf-checkout-shipping"]],viewQuery:function CheckoutShippingComponent_Query(rf,ctx){if(1&rf&&core.Gf(_c0,5),2&rf){let _t;core.iGM(_t=core.CRH())&&(ctx.addressForm=_t.first)}},decls:19,vars:22,consts:[[1,"accordion"],["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"btn","btn-light",3,"disabled","click"],[1,"card-body","collapse"],["class","form-check",4,"ngFor","ngForOf"],[1,"btn","btn-secondary","mt-3",3,"disabled","click"],[1,"btn","btn-light",3,"click"],[1,"d-flex","flex-wrap"],["class","customer-address",3,"click",4,"ngFor","ngForOf"],[1,"d-flex","align-items-end","ml-3","mb-3"],[1,"btn","btn-secondary",3,"click"],[1,"customer-address",3,"click"],["class","address-line",4,"ngFor","ngForOf"],[1,"address-line"],["customerForm","ngForm"],[1,"d-lg-flex"],["placeholder","First Name","name","firstName","required","",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Last Name","name","lastName","required","",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Email Address","name","emailAddress","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"address","availableCountries"],["addressForm",""],[1,"form-check"],["type","radio",1,"form-check-input",3,"ngModel","value","id","ngModelChange"],[1,"form-check-label","shipping-method",3,"for"],[1,"description"],[1,"price"]],template:function CheckoutShippingComponent_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0),core.YNc(1,CheckoutShippingComponent_div_1_Template,11,5,"div",1),core.ALo(2,"async"),core.ALo(3,"async"),core.YNc(4,CheckoutShippingComponent_div_4_Template,13,6,"div",1),core.ALo(5,"async"),core.YNc(6,CheckoutShippingComponent_div_6_Template,11,10,"div",1),core.ALo(7,"async"),core.ALo(8,"async"),core.TgZ(9,"div",2),core.TgZ(10,"div",3),core.TgZ(11,"button",4),core.NdJ("click",function CheckoutShippingComponent_Template_button_click_11_listener(){return ctx.step="selectMethod"}),core.ALo(12,"async"),core._uU(13,"Shipping Method"),core.qZA(),core.qZA(),core.TgZ(14,"div",5),core.YNc(15,CheckoutShippingComponent_div_15_Template,8,8,"div",6),core.ALo(16,"async"),core.TgZ(17,"button",7),core.NdJ("click",function CheckoutShippingComponent_Template_button_click_17_listener(){return ctx.proceedToPayment()}),core._uU(18,"Proceed to payment"),core.qZA(),core.qZA(),core.qZA(),core.qZA()),2&rf){let tmp_0_0,tmp_2_0,tmp_3_0;core.xp6(1),core.Q6J("ngIf",core.lcZ(2,8,ctx.signedIn$)&&(null==(tmp_0_0=core.lcZ(3,10,ctx.customerAddresses$))?null:tmp_0_0.length)),core.xp6(3),core.Q6J("ngIf",!core.lcZ(5,12,ctx.signedIn$)),core.xp6(2),core.Q6J("ngIf",!core.lcZ(7,14,ctx.signedIn$)||0===(null==(tmp_2_0=core.lcZ(8,16,ctx.customerAddresses$))?null:tmp_2_0.length)),core.xp6(5),core.Q6J("disabled","selectMethod"!==ctx.step||0===(null==(tmp_3_0=core.lcZ(12,18,ctx.eligibleShippingMethods$))?null:tmp_3_0.length)),core.xp6(3),core.ekj("show","selectMethod"===ctx.step),core.xp6(1),core.Q6J("ngForOf",core.lcZ(16,20,ctx.eligibleShippingMethods$)),core.xp6(2),core.Q6J("disabled",!ctx.shippingMethodId)}},directives:[common.O5,common.sg,fesm2015_forms._Y,fesm2015_forms.JL,fesm2015_forms.F,fesm2015_forms.Fj,fesm2015_forms.Q7,fesm2015_forms.JJ,fesm2015_forms.On,address_form_component.C,fesm2015_forms._],pipes:[common.Ov,format_price_pipe.C],styles:["[_nghost-%COMP%]{display:block;margin-bottom:3rem}.customer-address[_ngcontent-%COMP%]{display:inline-block;font-size:.875rem;padding:1rem;margin-right:1rem;margin-bottom:1rem;border-radius:.25rem;cursor:pointer;border:1px solid #e9ecef;transition:background-color .2s}.customer-address[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.shipping-method[_ngcontent-%COMP%]{display:flex}.shipping-method[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{margin-left:1rem}"],changeDetection:0});var sign_in_component=__webpack_require__(6059);const checkout_sign_in_component_c0=function(){return["/checkout","shipping"]},_c1=function(){return["./shipping"]};class CheckoutSignInComponent{}CheckoutSignInComponent.\u0275fac=function CheckoutSignInComponent_Factory(t){return new(t||CheckoutSignInComponent)},CheckoutSignInComponent.\u0275cmp=core.Xpm({type:CheckoutSignInComponent,selectors:[["vsf-checkout-sign-in"]],decls:12,vars:5,consts:[[1,"sign-in-row"],[3,"navigateToOnSuccess","displayRegisterLink"],[1,"or"],[1,"card","guest"],[1,"card-body","d-flex","align-items-center"],[1,"btn","btn-primary",3,"routerLink"]],template:function CheckoutSignInComponent_Template(rf,ctx){1&rf&&(core.TgZ(0,"h2"),core._uU(1,"Already have an account?"),core.qZA(),core.TgZ(2,"div",0),core._UZ(3,"vsf-sign-in",1),core.TgZ(4,"div",2),core.TgZ(5,"div"),core._uU(6,"or"),core.qZA(),core.qZA(),core.TgZ(7,"div",3),core.TgZ(8,"div",4),core.TgZ(9,"div"),core.TgZ(10,"a",5),core._uU(11,"Continue as guest"),core.qZA(),core.qZA(),core.qZA(),core.qZA(),core.qZA()),2&rf&&(core.xp6(3),core.Q6J("navigateToOnSuccess",core.DdM(3,checkout_sign_in_component_c0))("displayRegisterLink",!1),core.xp6(7),core.Q6J("routerLink",core.DdM(4,_c1)))},directives:[sign_in_component.F,router.yS],styles:[".sign-in-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-evenly;align-items:center;margin-bottom:1rem}@media (min-width:992px){.sign-in-row[_ngcontent-%COMP%]{flex-direction:row;align-items:inherit}}.or[_ngcontent-%COMP%]{padding:1rem;font-size:2em}.guest[_ngcontent-%COMP%], .or[_ngcontent-%COMP%]{display:flex;align-items:center}.guest[_ngcontent-%COMP%]{margin-top:2rem}"],changeDetection:0});const GET_ORDER_FOR_CHECKOUT=core_cjs.gql`
    query GetOrderForCheckout {
        activeOrder {
            ...Cart
            shippingAddress {
                ...OrderAddress
            }
        }
    }
    ${fragments_graphql.Gd}
    ${fragments_graphql.sO}
`;class CheckoutResolver{constructor(dataService){this.dataService=dataService}resolve(route,state){const stream=this.dataService.query(GET_ORDER_FOR_CHECKOUT).pipe((0,map.U)(data=>data.activeOrder)).pipe((0,shareReplay.d)(1));return stream.pipe((0,take.q)(1),(0,map.U)(()=>stream))}}CheckoutResolver.\u0275fac=function CheckoutResolver_Factory(t){return new(t||CheckoutResolver)(core.LFG(data_service.D))},CheckoutResolver.\u0275prov=core.Yz7({token:CheckoutResolver,factory:CheckoutResolver.\u0275fac,providedIn:"root"});class CheckoutGuard{constructor(router,dataService,stateService){this.router=router,this.dataService=dataService,this.stateService=stateService}canActivate(route){const orderState$=this.dataService.query(GET_ORDER_FOR_CHECKOUT,void 0,"cache-first").pipe((0,map.U)(data=>data.activeOrder?data.activeOrder.state:"")),signedIn$=this.stateService.select(state=>state.signedIn);return(0,combineLatest.aj)(orderState$,signedIn$).pipe((0,map.U)(([orderState,signedIn])=>{const component=route.component;return component===CheckoutSignInComponent?signedIn?(this.router.navigate(["/checkout","shipping"]),!1):"AddingItems"===orderState||"ArrangingPayment"===orderState&&(this.router.navigate(["/checkout","payment"]),!1):component===CheckoutShippingComponent?"AddingItems"===orderState||"ArrangingPayment"===orderState&&(this.router.navigate(["/checkout","payment"]),!1):component!==CheckoutPaymentComponent||("ArrangingPayment"===orderState||"AddingItems"===orderState&&(this.router.navigate(["/checkout"]),!1))}))}}CheckoutGuard.\u0275fac=function CheckoutGuard_Factory(t){return new(t||CheckoutGuard)(core.LFG(router.F0),core.LFG(data_service.D),core.LFG(state_service.b))},CheckoutGuard.\u0275prov=core.Yz7({token:CheckoutGuard,factory:CheckoutGuard.\u0275fac,providedIn:"root"});const routes=[{path:"",component:CheckoutProcessComponent,resolve:{activeOrder:CheckoutResolver},children:[{path:"",pathMatch:"full",component:CheckoutSignInComponent,canActivate:[CheckoutGuard]},{path:"shipping",component:CheckoutShippingComponent,canActivate:[CheckoutGuard]},{path:"payment",component:CheckoutPaymentComponent,canActivate:[CheckoutGuard]},{path:"confirmation/:code",component:CheckoutConfirmationComponent,canActivate:[CheckoutGuard]}]}];class CheckoutModule{}CheckoutModule.\u0275fac=function CheckoutModule_Factory(t){return new(t||CheckoutModule)},CheckoutModule.\u0275mod=core.oAB({type:CheckoutModule}),CheckoutModule.\u0275inj=core.cJS({imports:[[shared_module.m,router.Bz.forChild(routes)]]})}};