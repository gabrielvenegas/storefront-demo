(self.webpackChunkvendure_angular_storefront=self.webpackChunkvendure_angular_storefront||[]).push([[565],{2565:function(e,t,n){"use strict";n.r(t),n.d(t,{AccountModule:function(){return _e}});var r=n(52080),s=n(93341),i=n(54587),o=n(79996),a=n(95371),d=n(11785),c=n(29469),u=n(61116),l=n(91743),p=function(e){return["./",e]};function m(e,t){if(1&e&&(d.TgZ(0,"vsf-address-card",2),d.TgZ(1,"a",3),d._uU(2," Edit "),d.qZA(),d.qZA()),2&e){var n=t.$implicit;d.Q6J("address",n),d.xp6(1),d.Q6J("routerLink",d.VKq(2,p,n.id))}}var g,f,v,h=function(){function e(e){this.dataService=e}return e.prototype.ngOnInit=function(){this.addresses$=this.dataService.query(a.K5).pipe((0,o.U)(function(e){return e.activeCustomer&&e.activeCustomer.addresses}))},e.\u0275fac=function(t){return new(t||e)(d.Y36(c.D))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-account-address-book"]],decls:3,vars:3,consts:[[1,"card-deck"],[3,"address",4,"ngFor","ngForOf"],[3,"address"],[1,"btn","btn-secondary","btn-sm",3,"routerLink"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.YNc(1,m,3,4,"vsf-address-card",1),d.ALo(2,"async"),d.qZA()),2&e&&(d.xp6(1),d.Q6J("ngForOf",d.lcZ(2,1,t.addresses$)))},directives:[u.sg,l.l,r.yS],pipes:[u.Ov],styles:[""],changeDetection:0}),e}(),A=n(43835),Z=n(44689),w=n(5251),b=n(64762),y=n(43802),q=n(40551),C=(0,y.ZP)(g||(g=(0,b.cy)(["\n    mutation UpdateAddress($input: UpdateAddressInput!) {\n        updateCustomerAddress(input: $input) {\n            ...Address\n        }\n    }\n    ","\n"],["\n    mutation UpdateAddress($input: UpdateAddressInput!) {\n        updateCustomerAddress(input: $input) {\n            ...Address\n        }\n    }\n    ","\n"])),q.UY),S=n(37305),T=["addressForm"],k=function(){function e(e,t){this.route=e,this.dataService=t}return e.prototype.ngOnInit=function(){var e=this;this.address$=this.route.paramMap.pipe((0,o.U)(function(e){return e.get("id")}),(0,A.h)(w.b),(0,Z.w)(function(t){return e.dataService.query(a.K5).pipe((0,o.U)(function(e){return e.activeCustomer&&e.activeCustomer.addresses}),(0,A.h)(w.b),(0,o.U)(function(e){return e.find(function(e){return e.id===t})}))})),this.availableCountries$=this.dataService.query(a.n1).pipe((0,o.U)(function(e){return e.availableCountries}))},e.prototype.updateAddress=function(){var e=this,t=this.route.snapshot.paramMap.get("id");if(t){var n=this.addressForm.addressForm.value;this.dataService.mutate(C,{input:{id:t,city:n.city,company:n.company,countryCode:n.countryCode,customFields:n.customFields,defaultBillingAddress:n.defaultBillingAddress,defaultShippingAddress:n.defaultShippingAddress,fullName:n.fullName,phoneNumber:n.phoneNumber,postalCode:n.postalCode,province:n.province,streetLine1:n.streetLine1,streetLine2:n.streetLine2}}).subscribe(function(){e.addressForm.addressForm.markAsPristine()})}},e.\u0275fac=function(t){return new(t||e)(d.Y36(r.gz),d.Y36(c.D))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-account-address-detail"]],viewQuery:function(e,t){var n;1&e&&d.Gf(T,7),2&e&&d.iGM(n=d.CRH())&&(t.addressForm=n.first)},decls:6,vars:7,consts:[[3,"address","availableCountries"],["addressForm",""],[1,"btn","btn-secondary","mt-3",3,"disabled","click"]],template:function(e,t){if(1&e&&(d._UZ(0,"vsf-address-form",0,1),d.ALo(2,"async"),d.ALo(3,"async"),d.TgZ(4,"button",2),d.NdJ("click",function(){return t.updateAddress()}),d._uU(5,"Update Address"),d.qZA()),2&e){var n=d.MAs(1);d.Q6J("address",d.lcZ(2,3,t.address$))("availableCountries",d.lcZ(3,5,t.availableCountries$)),d.xp6(4),d.Q6J("disabled",n.addressForm.invalid||n.addressForm.pristine)}},directives:[S.C],pipes:[u.Ov],styles:[""],changeDetection:0}),e}(),N=(0,y.ZP)(f||(f=(0,b.cy)(["\n    mutation ChangePassword($old: String! $new: String!) {\n        updateCustomerPassword(currentPassword: $old newPassword: $new) {\n            ... on Success {\n                success\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"],["\n    mutation ChangePassword($old: String! $new: String!) {\n        updateCustomerPassword(currentPassword: $old newPassword: $new) {\n            ... on Success {\n                success\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"])),q.wq),x=(0,y.ZP)(v||(v=(0,b.cy)(["\n    mutation ChangeEmailAddress($password: String! $emailAddress: String!) {\n        requestUpdateCustomerEmailAddress(password: $password newEmailAddress: $emailAddress) {\n            ... on Success {\n                success\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"],["\n    mutation ChangeEmailAddress($password: String! $emailAddress: String!) {\n        requestUpdateCustomerEmailAddress(password: $password newEmailAddress: $emailAddress) {\n            ... on Success {\n                success\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"])),q.wq),J=n(11462);function M(e,t){if(1&e){var n=d.EpF();d.ynx(0),d.TgZ(1,"form",null,12),d.TgZ(3,"div",5),d.TgZ(4,"label",13),d._uU(5,"Password"),d.qZA(),d.TgZ(6,"input",14),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().password=e}),d.qZA(),d.qZA(),d.TgZ(7,"div",5),d.TgZ(8,"label",15),d._uU(9,"New email address"),d.qZA(),d.TgZ(10,"input",16),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().emailAddress=e}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(11,"button",10),d.NdJ("click",function(){return d.CHM(n),d.oxw().changeEmailAddress()}),d._uU(12,"Verify new email address"),d.qZA(),d.BQk()}if(2&e){var r=d.MAs(2),s=d.oxw();d.xp6(6),d.Q6J("ngModel",s.password),d.xp6(4),d.Q6J("ngModel",s.emailAddress),d.xp6(1),d.Q6J("disabled",r.invalid||r.pristine)}}function U(e,t){if(1&e&&(d.ynx(0),d.TgZ(1,"div",17),d._uU(2),d.qZA(),d.BQk()),2&e){var n=d.oxw();d.xp6(2),d.hij(" ",n.changeEmailAddressMessage," ")}}var $,O=function(){function e(e,t){this.dataService=e,this.changeDetectorRef=t,this.currentPassword="",this.newPassword="",this.password="",this.emailAddress="",this.changeEmailAddressMessage=""}return e.prototype.changePassword=function(){var e=this;this.dataService.mutate(N,{old:this.currentPassword,new:this.newPassword}).subscribe(function(){e.currentPassword="",e.newPassword="",e.changeDetectorRef.markForCheck()})},e.prototype.changeEmailAddress=function(){var e=this;this.dataService.mutate(x,{password:this.password,emailAddress:this.emailAddress}).subscribe(function(){e.changeEmailAddressMessage="To complete the process, please check your email ("+e.emailAddress+") to verify the address.",e.password="",e.emailAddress="",e.changeDetectorRef.markForCheck()})},e.\u0275fac=function(t){return new(t||e)(d.Y36(c.D),d.Y36(d.sBO))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-account-change-credentials"]],decls:23,vars:5,consts:[[1,"row","justify-content-around"],[1,"card","col-md-5"],[1,"card-body"],[1,"card-title"],["passwordForm","ngForm"],[1,"form-group"],["for","currentPassword"],["name","currentPassword","type","password","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","newPassword"],["name","newPassword","type","password","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn-secondary","mt-3",3,"disabled","click"],[4,"ngIf"],["emailForm","ngForm"],["for","password"],["name","password","type","password","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","emailAddress"],["name","emailAddress","required","",1,"form-control",3,"ngModel","ngModelChange"],["role","alert",1,"alert","alert-primary"]],template:function(e,t){if(1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"div",2),d.TgZ(3,"h5",3),d._uU(4,"Change password"),d.qZA(),d.TgZ(5,"form",null,4),d.TgZ(7,"div",5),d.TgZ(8,"label",6),d._uU(9,"Current password"),d.qZA(),d.TgZ(10,"input",7),d.NdJ("ngModelChange",function(e){return t.currentPassword=e}),d.qZA(),d.qZA(),d.TgZ(11,"div",5),d.TgZ(12,"label",8),d._uU(13,"New password"),d.qZA(),d.TgZ(14,"input",9),d.NdJ("ngModelChange",function(e){return t.newPassword=e}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(15,"button",10),d.NdJ("click",function(){return t.changePassword()}),d._uU(16,"Set password"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(17,"div",1),d.TgZ(18,"div",2),d.TgZ(19,"h5",3),d._uU(20,"Change email address"),d.qZA(),d.YNc(21,M,13,3,"ng-container",11),d.YNc(22,U,3,1,"ng-container",11),d.qZA(),d.qZA(),d.qZA()),2&e){var n=d.MAs(6);d.xp6(10),d.Q6J("ngModel",t.currentPassword),d.xp6(4),d.Q6J("ngModel",t.newPassword),d.xp6(1),d.Q6J("disabled",n.invalid||n.pristine),d.xp6(6),d.Q6J("ngIf",!t.changeEmailAddressMessage),d.xp6(1),d.Q6J("ngIf",t.changeEmailAddressMessage)}},directives:[J._Y,J.JL,J.F,J.Fj,J.Q7,J.JJ,J.On,u.O5],styles:[""],changeDetection:0}),e}(),P=(0,y.ZP)($||($=(0,b.cy)(["\n    mutation UpdateCustomerDetails($input: UpdateCustomerInput!) {\n        updateCustomer(input: $input) {\n            id\n            firstName\n            lastName\n            emailAddress\n            phoneNumber\n        }\n    }\n"],["\n    mutation UpdateCustomerDetails($input: UpdateCustomerInput!) {\n        updateCustomer(input: $input) {\n            id\n            firstName\n            lastName\n            emailAddress\n            phoneNumber\n        }\n    }\n"])));function _(e,t){if(1&e){var n=d.EpF();d.ynx(0),d.TgZ(1,"form",1),d.TgZ(2,"div",2),d.TgZ(3,"label",3),d._uU(4,"First name"),d.qZA(),d.TgZ(5,"div",4),d._UZ(6,"input",5),d.qZA(),d.qZA(),d.TgZ(7,"div",2),d.TgZ(8,"label",6),d._uU(9,"Last name"),d.qZA(),d.TgZ(10,"div",4),d._UZ(11,"input",7),d.qZA(),d.qZA(),d.TgZ(12,"div",2),d.TgZ(13,"label",8),d._uU(14,"Phone number"),d.qZA(),d.TgZ(15,"div",4),d._UZ(16,"input",9),d.qZA(),d.qZA(),d.qZA(),d.TgZ(17,"button",10),d.NdJ("click",function(){return d.CHM(n),d.oxw().updateDetails()}),d._uU(18,"Update Details"),d.qZA(),d.BQk()}if(2&e){var r=d.oxw();d.xp6(1),d.Q6J("formGroup",r.form),d.xp6(16),d.Q6J("disabled",r.form.invalid||r.form.pristine)}}var F,Q=function(){function e(e,t,n){this.dataService=e,this.formBuilder=t,this.changeDetectorRef=n}return e.prototype.ngOnInit=function(){var e=this;this.dataService.query(a.qx,{},"network-only").pipe((0,o.U)(function(e){return e.activeCustomer}),(0,A.h)(w.b)).subscribe(function(t){e.form=e.formBuilder.group({firstName:t.firstName,lastName:t.lastName,phoneNumber:t.phoneNumber}),e.changeDetectorRef.markForCheck()})},e.prototype.updateDetails=function(){var e=this,t=this.form.value;this.dataService.mutate(P,{input:{firstName:t.firstName,lastName:t.lastName,phoneNumber:t.phoneNumber}}).subscribe(function(){e.form.markAsPristine()})},e.\u0275fac=function(t){return new(t||e)(d.Y36(c.D),d.Y36(J.qu),d.Y36(d.sBO))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-account-customer-details"]],decls:1,vars:1,consts:[[4,"ngIf"],[3,"formGroup"],[1,"form-group","row"],["for","firstName",1,"col-sm-3","col-form-label"],[1,"col-sm-9"],["formControlName","firstName","id","firstName",1,"form-control"],["for","lastName",1,"col-sm-3","col-form-label"],["formControlName","lastName","id","lastName",1,"form-control"],["for","phoneNumber",1,"col-sm-3","col-form-label"],["formControlName","phoneNumber","id","phoneNumber",1,"form-control"],[1,"btn","btn-secondary","mt-3",3,"disabled","click"]],template:function(e,t){1&e&&d.YNc(0,_,19,2,"ng-container",0),2&e&&d.Q6J("ngIf",t.form)},directives:[u.O5,J._Y,J.JL,J.sg,J.Fj,J.JJ,J.u],styles:[""],changeDetection:0}),e}(),Y=(0,y.ZP)(F||(F=(0,b.cy)(["\n    query GetAccountOverview {\n        activeCustomer {\n            id\n            title\n            firstName\n            lastName\n            emailAddress\n        }\n    }\n"],["\n    query GetAccountOverview {\n        activeCustomer {\n            id\n            title\n            firstName\n            lastName\n            emailAddress\n        }\n    }\n"]))),I=n(35159);function D(e,t){if(1&e&&(d.ynx(0),d.TgZ(1,"h2",1),d._uU(2),d.qZA(),d.TgZ(3,"p",2),d._uU(4),d.qZA(),d.BQk()),2&e){var n=t.ngIf;d.xp6(2),d.AsE(" ",n.firstName," ",n.lastName," "),d.xp6(2),d.Oqu(n.emailAddress)}}var L,E=function(){function e(e,t,n){this.dataService=e,this.stateService=t,this.router=n}return e.prototype.ngOnInit=function(){this.activeCustomer$=this.dataService.query(Y).pipe((0,o.U)(function(e){return e.activeCustomer}),(0,A.h)(w.b))},e.\u0275fac=function(t){return new(t||e)(d.Y36(c.D),d.Y36(I.b),d.Y36(r.F0))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-account-dashboard"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"display-4"],[1,"lead"]],template:function(e,t){1&e&&(d.YNc(0,D,5,3,"ng-container",0),d.ALo(1,"async")),2&e&&d.Q6J("ngIf",d.lcZ(1,1,t.activeCustomer$))},directives:[u.O5],pipes:[u.Ov],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),e}(),R=(0,y.ZP)(L||(L=(0,b.cy)(["\n    query GetOrder($code: String!) {\n        orderByCode(code: $code) {\n            ...Cart\n            shippingAddress {\n                ...OrderAddress\n            }\n            billingAddress {\n                ...OrderAddress\n            }\n        }\n    }\n    ","\n    ","\n"],["\n    query GetOrder($code: String!) {\n        orderByCode(code: $code) {\n            ...Cart\n            shippingAddress {\n                ...OrderAddress\n            }\n            billingAddress {\n                ...OrderAddress\n            }\n        }\n    }\n    ","\n    ","\n"])),q.Gd,q.sO),B=n(34800);function j(e,t){if(1&e&&(d.ynx(0),d.TgZ(1,"h2"),d._uU(2),d.qZA(),d.TgZ(3,"div",1),d.TgZ(4,"div",2),d._UZ(5,"vsf-cart-contents",3),d.qZA(),d.TgZ(6,"div",4),d._UZ(7,"vsf-address-card",5),d.qZA(),d.qZA(),d.BQk()),2&e){var n=t.ngIf;d.xp6(2),d.hij("Order ",n.code,""),d.xp6(3),d.Q6J("cart",n),d.xp6(2),d.Q6J("address",n.shippingAddress)}}var G,X=function(){function e(e,t){this.dataService=e,this.route=t}return e.prototype.ngOnInit=function(){var e=this;this.order$=this.route.paramMap.pipe((0,o.U)(function(e){return e.get("code")}),(0,A.h)(w.b),(0,Z.w)(function(t){return e.dataService.query(R,{code:t})}),(0,o.U)(function(e){return e.orderByCode}))},e.\u0275fac=function(t){return new(t||e)(d.Y36(c.D),d.Y36(r.gz))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-account-order-detail"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"row"],[1,"col-12","col-md-8"],[3,"cart"],[1,"col-12","col-md-4"],["title","Shipping address",3,"address"]],template:function(e,t){1&e&&(d.YNc(0,j,8,3,"ng-container",0),d.ALo(1,"async")),2&e&&d.Q6J("ngIf",d.lcZ(1,1,t.order$))},directives:[u.O5,B.o,l.l],pipes:[u.Ov],styles:[""],changeDetection:0}),e}(),z=function(e){return e.ASC="ASC",e.DESC="DESC",e}({}),H=(0,y.ZP)(G||(G=(0,b.cy)(["\n    query GetOrderList($options: OrderListOptions) {\n        activeCustomer {\n            id\n            orders(options: $options) {\n                items {\n                    id\n                    updatedAt\n                    code\n                    state\n                    currencyCode\n                    total\n                }\n                totalItems\n            }\n        }\n    }\n"],["\n    query GetOrderList($options: OrderListOptions) {\n        activeCustomer {\n            id\n            orders(options: $options) {\n                items {\n                    id\n                    updatedAt\n                    code\n                    state\n                    currencyCode\n                    total\n                }\n                totalItems\n            }\n        }\n    }\n"]))),V=n(51580),K=function(e){return["./",e]};function W(e,t){if(1&e&&(d.TgZ(0,"tr"),d.TgZ(1,"th",3),d.TgZ(2,"a",4),d._uU(3),d.qZA(),d.qZA(),d.TgZ(4,"td"),d._uU(5),d.qZA(),d.TgZ(6,"td"),d._uU(7),d.ALo(8,"formatPrice"),d.qZA(),d.TgZ(9,"td"),d._uU(10),d.ALo(11,"date"),d.qZA(),d.qZA()),2&e){var n=t.$implicit;d.xp6(2),d.Q6J("routerLink",d.VKq(10,K,n.code)),d.xp6(1),d.hij(" ",n.code," "),d.xp6(2),d.Oqu(n.state),d.xp6(2),d.Oqu(d.lcZ(8,5,n.total)),d.xp6(3),d.Oqu(d.xi3(11,7,n.updatedAt,"short"))}}var ee,te=function(){function e(e){this.dataService=e}return e.prototype.ngOnInit=function(){this.orders$=this.dataService.query(H,{options:{filter:{active:{eq:!1}},sort:{createdAt:z.DESC}}}).pipe((0,o.U)(function(e){return e.activeCustomer&&e.activeCustomer.orders.items}))},e.\u0275fac=function(t){return new(t||e)(d.Y36(c.D))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-account-order-list"]],decls:14,vars:3,consts:[[1,"table"],["scope","col"],[4,"ngFor","ngForOf"],["scope","row"],[3,"routerLink"]],template:function(e,t){1&e&&(d.TgZ(0,"table",0),d.TgZ(1,"thead"),d.TgZ(2,"tr"),d.TgZ(3,"th",1),d._uU(4,"Order code"),d.qZA(),d.TgZ(5,"th",1),d._uU(6,"Status"),d.qZA(),d.TgZ(7,"th",1),d._uU(8,"Total"),d.qZA(),d.TgZ(9,"th",1),d._uU(10,"Last updated"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(11,"tbody"),d.YNc(12,W,12,12,"tr",2),d.ALo(13,"async"),d.qZA(),d.qZA()),2&e&&(d.xp6(12),d.Q6J("ngForOf",d.lcZ(13,1,t.orders$)))},directives:[u.sg,r.yS],pipes:[u.Ov,V.C,u.uU],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),e}(),ne=(0,y.ZP)(ee||(ee=(0,b.cy)(["\n    mutation SignOut {\n        logout {\n            success\n        }\n    }\n"],["\n    mutation SignOut {\n        logout {\n            success\n        }\n    }\n"]))),re=function(){return["./"]},se=function(){return{exact:!0}},ie=function(){return["./","orders"]},oe=function(){return["./","address-book"]},ae=function(){return["./","details"]},de=function(){return["./","change-credentials"]};function ce(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",4),d.TgZ(1,"div",5),d.TgZ(2,"a",6),d._uU(3," Dashboard "),d.qZA(),d.TgZ(4,"a",7),d._uU(5," Orders "),d.qZA(),d.TgZ(6,"a",7),d._uU(7," Address book "),d.qZA(),d.TgZ(8,"a",7),d._uU(9," Personal details "),d.qZA(),d.TgZ(10,"a",7),d._uU(11," Change credentials "),d.qZA(),d.TgZ(12,"a",8),d.TgZ(13,"button",9),d.NdJ("click",function(){return d.CHM(n),d.oxw().signOut()}),d._uU(14,"Sign out"),d.qZA(),d.qZA(),d.qZA(),d.qZA()}2&e&&(d.xp6(2),d.Q6J("routerLink",d.DdM(6,re))("routerLinkActiveOptions",d.DdM(7,se)),d.xp6(2),d.Q6J("routerLink",d.DdM(8,ie)),d.xp6(2),d.Q6J("routerLink",d.DdM(9,oe)),d.xp6(2),d.Q6J("routerLink",d.DdM(10,ae)),d.xp6(2),d.Q6J("routerLink",d.DdM(11,de)))}var ue,le,pe=function(){function e(e,t,n){this.dataService=e,this.stateService=t,this.router=n,this.isSignedIn$=this.stateService.select(function(e){return e.signedIn})}return e.prototype.signOut=function(){var e=this;this.dataService.mutate(ne).subscribe({next:function(){e.stateService.setState("signedIn",!1),e.router.navigate(["/"])}})},e.\u0275fac=function(t){return new(t||e)(d.Y36(c.D),d.Y36(I.b),d.Y36(r.F0))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-account"]],decls:7,vars:7,consts:[[1,"container"],[1,"row"],["class","col-12 col-md-3",4,"ngIf"],[1,"col-12"],[1,"col-12","col-md-3"],[1,"list-group-flush"],["routerLinkActive","active",1,"list-group-item","list-group-item-action",3,"routerLink","routerLinkActiveOptions"],["routerLinkActive","active",1,"list-group-item","list-group-item-action",3,"routerLink"],[1,"list-group-item"],[1,"btn","btn-warning","btn-sm","btn-block",3,"click"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.YNc(2,ce,15,12,"div",2),d.ALo(3,"async"),d.TgZ(4,"div",3),d.ALo(5,"async"),d._UZ(6,"router-outlet"),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(2),d.Q6J("ngIf",d.lcZ(3,3,t.isSignedIn$)),d.xp6(2),d.ekj("col-md-9",d.lcZ(5,5,t.isSignedIn$)))},directives:[u.O5,r.lC,r.yS,r.Od],pipes:[u.Ov],styles:["[_nghost-%COMP%]{display:block;margin-top:2rem}"],changeDetection:0}),e}(),me=(0,y.ZP)(ue||(ue=(0,b.cy)(["\n    mutation VerifyChangeEmailAddress($token: String!) {\n        updateCustomerEmailAddress(token: $token) {\n            ... on Success {\n                success\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"],["\n    mutation VerifyChangeEmailAddress($token: String!) {\n        updateCustomerEmailAddress(token: $token) {\n            ... on Success {\n                success\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"])),q.wq),ge=function(e,t,n){return{"alert-secondary":e,"alert-danger":t,"alert-success":n}},fe=function(){function e(e,t,n,r){this.route=e,this.router=t,this.dataService=n,this.stateService=r,this.message="Verifying new email address...",this.state="pending"}return e.prototype.ngOnInit=function(){this.verify()},e.prototype.verify=function(){var e=this,t=this.route.snapshot.queryParamMap.get("token");t?this.dataService.mutate(me,{token:t}).subscribe(function(){e.message="Your new email address has been verified!",e.state="success"},function(t){e.state="error",e.message=t.message}):(this.message="No token provided! Cannot verify email address.",this.state="error")},e.\u0275fac=function(t){return new(t||e)(d.Y36(r.gz),d.Y36(r.F0),d.Y36(c.D),d.Y36(I.b))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-change-email-address"]],decls:2,vars:6,consts:[["role","alert",1,"alert","mt-3",3,"ngClass"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d._uU(1),d.qZA()),2&e&&(d.Q6J("ngClass",d.kEZ(2,ge,"pending"===t.state,"error"===t.state,"success"===t.state)),d.xp6(1),d.hij(" ",t.message,"\n"))},directives:[u.mk],styles:[""]}),e}(),ve=(0,y.ZP)(le||(le=(0,b.cy)(["\n    mutation RequestPasswordReset($emailAddress: String!) {\n        requestPasswordReset(emailAddress: $emailAddress) {\n            ... on Success {\n                success\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"],["\n    mutation RequestPasswordReset($emailAddress: String!) {\n        requestPasswordReset(emailAddress: $emailAddress) {\n            ... on Success {\n                success\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"])),q.wq),he=n(60015);function Ae(e,t){if(1&e){var n=d.EpF();d.ynx(0),d.TgZ(1,"input",4),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().emailAddress=e}),d.qZA(),d.TgZ(2,"button",5),d._uU(3," Reset password "),d.qZA(),d.BQk()}if(2&e){var r=d.oxw(),s=d.MAs(1);d.xp6(1),d.Q6J("ngModel",r.emailAddress),d.xp6(1),d.Q6J("disabled",s.invalid||r.submitted)}}function Ze(e,t){if(1&e&&(d.TgZ(0,"div",6),d._uU(1," An email has been sent to "),d.TgZ(2,"strong"),d._uU(3),d.qZA(),d._uU(4,". Please check and follow the included instructions. "),d.qZA()),2&e){var n=d.oxw();d.xp6(3),d.Oqu(n.emailAddress)}}var we=function(){function e(e,t){this.dataService=e,this.route=t,this.emailAddress="",this.submitted=!1,this.emailAddress=this.route.snapshot.paramMap.get("email")||""}return e.prototype.resetPassword=function(){var e=this;this.dataService.mutate(ve,{emailAddress:this.emailAddress}).subscribe(function(){e.submitted=!0})},e.\u0275fac=function(t){return new(t||e)(d.Y36(c.D),d.Y36(r.gz))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-forgotten-password"]],decls:5,vars:2,consts:[[3,"submit"],["resetForm","ngForm"],[4,"ngIf"],["class","alert alert-success","role","alert",4,"ngIf"],["placeholder","Email address","name","emailAddress","type","email","email","","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary","btn-block","mt-3",3,"disabled"],["role","alert",1,"alert","alert-success"]],template:function(e,t){1&e&&(d.TgZ(0,"form",0,1),d.NdJ("submit",function(){return t.resetPassword()}),d.TgZ(2,"vsf-centered-card"),d.YNc(3,Ae,4,2,"ng-container",2),d.YNc(4,Ze,5,1,"div",3),d.qZA(),d.qZA()),2&e&&(d.xp6(3),d.Q6J("ngIf",!t.submitted),d.xp6(1),d.Q6J("ngIf",t.submitted))},directives:[J._Y,J.JL,J.F,he.x,u.O5,J.Fj,J.on,J.Q7,J.JJ,J.On],styles:["[_nghost-%COMP%]{display:block;margin-top:2rem}"]}),e}(),be=n(150);function ye(e,t){if(1&e&&(d.TgZ(0,"div",7),d._uU(1),d.qZA()),2&e){var n=d.oxw();d.xp6(1),d.hij(" Great! Now check your email (",n.emailAddress,") to complete registration. ")}}var qe,Ce=function(){function e(e,t){this.dataService=e,this.changeDetector=t,this.registrationSent=!1}return e.prototype.register=function(){var e=this;this.dataService.mutate(be.N,{input:{emailAddress:this.emailAddress,firstName:this.firstName,lastName:this.lastName}}).subscribe(function(){e.registrationSent=!0,e.changeDetector.markForCheck()})},e.\u0275fac=function(t){return new(t||e)(d.Y36(c.D),d.Y36(d.sBO))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-register"]],decls:9,vars:8,consts:[[3,"submit"],["registerForm","ngForm"],["placeholder","First name","name","firstName","required","",1,"form-control",3,"disabled","ngModel","ngModelChange"],["placeholder","Last name","name","lastName","required","",1,"form-control","mt-1",3,"disabled","ngModel","ngModelChange"],["placeholder","Email address","name","emailAddress","required","","type","email","email","",1,"form-control","mt-1",3,"disabled","ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary","btn-block","mt-3",3,"disabled"],["class","registration-sent",4,"ngIf"],[1,"registration-sent"]],template:function(e,t){if(1&e&&(d.TgZ(0,"form",0,1),d.NdJ("submit",function(){return t.register()}),d.TgZ(2,"vsf-centered-card"),d.TgZ(3,"input",2),d.NdJ("ngModelChange",function(e){return t.firstName=e}),d.qZA(),d.TgZ(4,"input",3),d.NdJ("ngModelChange",function(e){return t.lastName=e}),d.qZA(),d.TgZ(5,"input",4),d.NdJ("ngModelChange",function(e){return t.emailAddress=e}),d.qZA(),d.TgZ(6,"button",5),d._uU(7," Register "),d.qZA(),d.YNc(8,ye,2,1,"div",6),d.qZA(),d.qZA()),2&e){var n=d.MAs(1);d.xp6(3),d.Q6J("disabled",t.registrationSent)("ngModel",t.firstName),d.xp6(1),d.Q6J("disabled",t.registrationSent)("ngModel",t.lastName),d.xp6(1),d.Q6J("disabled",t.registrationSent)("ngModel",t.emailAddress),d.xp6(1),d.Q6J("disabled",n.invalid||t.registrationSent),d.xp6(2),d.Q6J("ngIf",t.registrationSent)}},directives:[J._Y,J.JL,J.F,he.x,J.Fj,J.Q7,J.JJ,J.On,J.on,u.O5],styles:["[_nghost-%COMP%]{display:block;margin-top:2rem}[_nghost-%COMP%]   .registration-sent[_ngcontent-%COMP%]{text-align:center;padding:2rem}"],changeDetection:0}),e}(),Se=(0,y.ZP)(qe||(qe=(0,b.cy)(["\n    mutation ResetPassword($token: String! $password: String!) {\n        resetPassword(token: $token password: $password) {\n            ...on CurrentUser {\n                id\n                identifier\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"],["\n    mutation ResetPassword($token: String! $password: String!) {\n        resetPassword(token: $token password: $password) {\n            ...on CurrentUser {\n                id\n                identifier\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"])),q.wq);function Te(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",5),d.TgZ(1,"input",6),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().password=e}),d.qZA(),d.TgZ(2,"div",7),d.TgZ(3,"button",8),d._uU(4," Reset password "),d.qZA(),d.qZA(),d.qZA()}if(2&e){var r=d.oxw(),s=d.MAs(1);d.xp6(1),d.Q6J("ngModel",r.password),d.xp6(2),d.Q6J("disabled",s.invalid)}}function ke(e,t){if(1&e&&(d.TgZ(0,"div",9),d._uU(1),d.qZA()),2&e){var n=d.oxw();d.xp6(1),d.hij(" ",n.error," ")}}var Ne,xe=function(){function e(e,t,n,r){this.dataService=e,this.stateService=t,this.route=n,this.router=r,this.password="",this.error="",this.token=this.route.snapshot.queryParamMap.get("token")||void 0,this.token||(this.error="No token provided! Cannot reset password.")}return e.prototype.confirmPasswordReset=function(){var e=this;this.token&&this.dataService.mutate(Se,{token:this.token,password:this.password}).subscribe(function(){e.stateService.setState("signedIn",!0),e.router.navigate(["/account"])})},e.\u0275fac=function(t){return new(t||e)(d.Y36(c.D),d.Y36(I.b),d.Y36(r.gz),d.Y36(r.F0))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-reset-password"]],decls:5,vars:2,consts:[[1,"mt-3",3,"submit"],["resetForm","ngForm"],["title","Reset password","subTitle","Choose a new password"],["class","input-group mb-3",4,"ngIf"],["class","alert alert-danger mt-3","role","alert",4,"ngIf"],[1,"input-group","mb-3"],["placeholder","Password","type","password","name","password","aria-describedby","button-verify","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-append"],["id","button-verify","type","submit",1,"btn","btn-primary",3,"disabled"],["role","alert",1,"alert","alert-danger","mt-3"]],template:function(e,t){1&e&&(d.TgZ(0,"form",0,1),d.NdJ("submit",function(){return t.confirmPasswordReset()}),d.TgZ(2,"vsf-centered-card",2),d.YNc(3,Te,5,2,"div",3),d.YNc(4,ke,2,1,"div",4),d.qZA(),d.qZA()),2&e&&(d.xp6(3),d.Q6J("ngIf",!t.error),d.xp6(1),d.Q6J("ngIf",t.error))},directives:[J._Y,J.JL,J.F,he.x,u.O5,J.Fj,J.Q7,J.JJ,J.On],styles:[""],changeDetection:0}),e}(),Je=(0,y.ZP)(Ne||(Ne=(0,b.cy)(["\n    mutation Verify($password: String!, $token: String!) {\n        verifyCustomerAccount(password: $password, token: $token) {\n            ...on CurrentUser {\n                id\n                identifier\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"],["\n    mutation Verify($password: String!, $token: String!) {\n        verifyCustomerAccount(password: $password, token: $token) {\n            ...on CurrentUser {\n                id\n                identifier\n            }\n            ...ErrorResult\n        }\n    }\n    ","\n"])),q.wq),Me=function(){function e(e,t,n,r){this.route=e,this.router=t,this.dataService=n,this.stateService=r,this.password=""}return e.prototype.verify=function(){var e=this,t=this.password,n=this.route.snapshot.queryParamMap.get("token");t&&n&&this.dataService.mutate(Je,{password:t,token:n}).subscribe(function(){e.stateService.setState("signedIn",!0),e.router.navigate(["/account"])})},e.\u0275fac=function(t){return new(t||e)(d.Y36(r.gz),d.Y36(r.F0),d.Y36(c.D),d.Y36(I.b))},e.\u0275cmp=d.Xpm({type:e,selectors:[["vsf-verify"]],decls:8,vars:2,consts:[[1,"mt-3",3,"submit"],["verifyForm","ngForm"],["title","Almost done!","subTitle","Now just choose a password to complete the process"],[1,"input-group","mb-3"],["placeholder","Password","type","password","name","password","aria-describedby","button-verify","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-append"],["id","button-verify","type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,t){if(1&e&&(d.TgZ(0,"form",0,1),d.NdJ("submit",function(){return t.verify()}),d.TgZ(2,"vsf-centered-card",2),d.TgZ(3,"div",3),d.TgZ(4,"input",4),d.NdJ("ngModelChange",function(e){return t.password=e}),d.qZA(),d.TgZ(5,"div",5),d.TgZ(6,"button",6),d._uU(7," Create account "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e){var n=d.MAs(1);d.xp6(4),d.Q6J("ngModel",t.password),d.xp6(2),d.Q6J("disabled",n.invalid)}},directives:[J._Y,J.JL,J.F,he.x,J.Fj,J.Q7,J.JJ,J.On],styles:[""]}),e}(),Ue=n(40878),$e=function(){function e(e,t){this.stateService=e,this.dataService=t}return e.prototype.canActivate=function(e){var t=this;return this.stateService.select(function(e){return e.signedIn}).pipe((0,Z.w)(function(e){return e?(0,Ue.of)(!0):t.dataService.query(a.qx).pipe((0,o.U)(function(e){return!!e.activeCustomer}))}))},e.\u0275fac=function(t){return new(t||e)(d.LFG(I.b),d.LFG(c.D))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Oe=function(){function e(e){this.stateService=e}return e.prototype.canActivate=function(e){return this.stateService.select(function(e){return e.signedIn}).pipe((0,o.U)(function(e){return!e}))},e.\u0275fac=function(t){return new(t||e)(d.LFG(I.b))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Pe=[{path:"",component:pe,children:[{path:"",pathMatch:"full",canActivate:[$e],component:E},{path:"orders",canActivate:[$e],component:te},{path:"orders/:code",canActivate:[$e],component:X},{path:"address-book",canActivate:[$e],component:h},{path:"address-book/:id",canActivate:[$e],component:k},{path:"details",canActivate:[$e],component:Q},{path:"change-credentials",canActivate:[$e],component:O},{path:"sign-in",canActivate:[Oe],component:i.F},{path:"register",canActivate:[Oe],component:Ce},{path:"verify",canActivate:[Oe],component:Me},{path:"reset-password",canActivate:[Oe],component:xe},{path:"forgotten-password",canActivate:[Oe],component:we},{path:"change-email-address",canActivate:[Oe],component:fe}]}],_e=function(){function e(){}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({providers:[$e,Oe],imports:[[s.m,r.Bz.forChild(Pe)]]}),e}()}}]);